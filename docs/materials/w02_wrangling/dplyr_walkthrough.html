<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Michael Hallquist, PSYC 859">
<meta name="dcterms.date" content="2026-01-22">

<title>Data wrangling in dplyr – Data Management and Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-203898e0a995a1603b190edd51f3a64a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../../rmd_style.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PSYC 859</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../materials.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#before-we-start-beware-namespace-collisions" id="toc-before-we-start-beware-namespace-collisions" class="nav-link active" data-scroll-target="#before-we-start-beware-namespace-collisions">Before we start: beware namespace collisions!</a>
  <ul class="collapse">
  <li><a href="#addressing-namespace-collisions" id="toc-addressing-namespace-collisions" class="nav-link" data-scroll-target="#addressing-namespace-collisions">Addressing namespace collisions</a></li>
  </ul></li>
  <li><a href="#data-pipelines" id="toc-data-pipelines" class="nav-link" data-scroll-target="#data-pipelines">Data pipelines</a>
  <ul class="collapse">
  <li><a href="#use-of-this-reference-in-tidyverse" id="toc-use-of-this-reference-in-tidyverse" class="nav-link" data-scroll-target="#use-of-this-reference-in-tidyverse">Use of ‘this’ reference in tidyverse</a></li>
  </ul></li>
  <li><a href="#special-values-to-watch-out-for-in-data-wrangling" id="toc-special-values-to-watch-out-for-in-data-wrangling" class="nav-link" data-scroll-target="#special-values-to-watch-out-for-in-data-wrangling">Special values to watch out for in data wrangling</a></li>
  <li><a href="#dplyr-fundamentals" id="toc-dplyr-fundamentals" class="nav-link" data-scroll-target="#dplyr-fundamentals">dplyr fundamentals</a>
  <ul class="collapse">
  <li><a href="#overview-a-first-pass-through-an-nhanes-dataset" id="toc-overview-a-first-pass-through-an-nhanes-dataset" class="nav-link" data-scroll-target="#overview-a-first-pass-through-an-nhanes-dataset">Overview: a first pass through an NHANES dataset</a></li>
  <li><a href="#group_by-summarize" id="toc-group_by-summarize" class="nav-link" data-scroll-target="#group_by-summarize">group_by + summarize</a></li>
  <li><a href="#grouped-summaries-of-several-variables" id="toc-grouped-summaries-of-several-variables" class="nav-link" data-scroll-target="#grouped-summaries-of-several-variables">Grouped summaries of several variables</a></li>
  <li><a href="#making-a-summarize-pipeline-even-more-beautiful" id="toc-making-a-summarize-pipeline-even-more-beautiful" class="nav-link" data-scroll-target="#making-a-summarize-pipeline-even-more-beautiful">Making a summarize pipeline even more beautiful</a></li>
  </ul></li>
  <li><a href="#examining-a-more-complex-multilevel-dataset-using-dplyr" id="toc-examining-a-more-complex-multilevel-dataset-using-dplyr" class="nav-link" data-scroll-target="#examining-a-more-complex-multilevel-dataset-using-dplyr">Examining a more complex multilevel dataset using dplyr</a>
  <ul class="collapse">
  <li><a href="#filter-obtaining-observations-rows-based-on-some-criteria" id="toc-filter-obtaining-observations-rows-based-on-some-criteria" class="nav-link" data-scroll-target="#filter-obtaining-observations-rows-based-on-some-criteria">filter: obtaining observations (rows) based on some criteria</a></li>
  <li><a href="#select-choose-variables-columns-based-on-some-criteria" id="toc-select-choose-variables-columns-based-on-some-criteria" class="nav-link" data-scroll-target="#select-choose-variables-columns-based-on-some-criteria">select: choose variables (columns) based on some criteria</a></li>
  <li><a href="#select-filter-zooming-in-on-specific-observations-and-variables" id="toc-select-filter-zooming-in-on-specific-observations-and-variables" class="nav-link" data-scroll-target="#select-filter-zooming-in-on-specific-observations-and-variables">select + filter: zooming in on specific observations and variables</a></li>
  <li><a href="#mutate-add-one-or-more-variables-that-are-a-function-of-other-variables" id="toc-mutate-add-one-or-more-variables-that-are-a-function-of-other-variables" class="nav-link" data-scroll-target="#mutate-add-one-or-more-variables-that-are-a-function-of-other-variables">mutate: add one or more variables that are a function of other variables</a></li>
  <li><a href="#arrange-reorder-observations-in-specific-order" id="toc-arrange-reorder-observations-in-specific-order" class="nav-link" data-scroll-target="#arrange-reorder-observations-in-specific-order">arrange: reorder observations in specific order</a></li>
  <li><a href="#a-more-realistic-example-preparation-for-multilevel-analysis" id="toc-a-more-realistic-example-preparation-for-multilevel-analysis" class="nav-link" data-scroll-target="#a-more-realistic-example-preparation-for-multilevel-analysis">A more realistic example: preparation for multilevel analysis</a></li>
  </ul></li>
  <li><a href="#reference-rows-columns-and-groups-in-dplyr" id="toc-reference-rows-columns-and-groups-in-dplyr" class="nav-link" data-scroll-target="#reference-rows-columns-and-groups-in-dplyr">Reference: Rows, columns, and groups in dplyr</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data wrangling in dplyr</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Michael Hallquist, PSYC 859 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>The goal of this document is to provide a basic introduction to data wrangling using functions from the so-called ‘tidyverse’ approach. The tidyverse (<a href="https://www.tidyverse.org" class="uri">https://www.tidyverse.org</a>) is a set of data science packages in <code>R</code> that are intended to provide a consistent paradigm for working with data. This approach unifies a previously inchoate landscape of different functions and packages in <code>R</code> that could be daunting to new users.</p>
<p>Although I do not claim that the tidyverse approach is best according to all possible criteria, I believe that it is the best paradigm for working with data in R for social scientists, many of whom do not have a formal background in computer programming.</p>
<p>Here, I will draw primarily from the <em>tidyr</em> and <em>dplyr</em> packages in R.</p>
<p>For an excellent book-length treatment of the tidyverse approach, see <a href="https://r4ds.hadley.nz">R for Data Science (2nd edition)</a> by Hadley Wickham, Mine Cetinkaya-Rundel, and Garrett Grolemund.</p>
<section id="before-we-start-beware-namespace-collisions" class="level1">
<h1>Before we start: beware namespace collisions!</h1>
<p>One of the most irritating problems you may encounter in the tidyverse world (and more generally, in R) is when code that previously worked suddenly throws an inexplicable error.</p>
<p>For example:</p>
<pre><code>&gt; survey %&gt;% group_by(R_exp) %&gt;% 
summarize(m_age=mean(Psych_age_yrs), sd_age=sd(Psych_age_yrs))

Error in summarize(., m_age = mean(Psych_age_yrs), sd_age = sd(Psych_age_yrs)) : 
argument "by" is missing, with no default</code></pre>
<p>By using fairly intuitive data wrangling verbs such as ‘summarize’ and ‘select’, <code>dplyr</code> (and sometimes <code>tidyr</code>) sometimes uses the same function names as other packages. For example, <code>Hmisc</code> has a <code>summarize</code> function that does not operate in the same way as <code>summarize</code> in <code>dplyr</code>. Also, the predecessor to <code>dplyr</code> was called <code>plyr</code>. Although largely outmoded, it has a few remaining functions that may be useful. But… many of these functions have the same names in <code>dplyr</code> but operate differently (the syntax is not the same!), which can be a common source of collisions when using <code>dplyr</code>.</p>
<p>This points to the problem of what are called ‘namespace collisions.’ That is, when R looks for a function (or any object) in the global environment, it searches through a ‘path’. You can see the nitty gritty using <code>searchpaths()</code>. But the TL;DR is that if you – or any function you call on – loads another package, that package may override a <code>dplyr</code> function and make your code crash!</p>
<section id="addressing-namespace-collisions" class="level2">
<h2 class="anchored" data-anchor-id="addressing-namespace-collisions">Addressing namespace collisions</h2>
<ol type="1">
<li>Watch out for warnings about objects being ‘masked’ when packages are loaded.</li>
<li>Explicitly specify the package where your desired function lives using the double colon operator. Example: <code>dplyr::summarize</code>.</li>
<li>Try to load tidyverse packages using <code>library(tidyverse)</code>. This handles collisions within the tidyverse!</li>
</ol>
<p>For example, in this document, <code>multilevel</code> pulls in <code>MASS</code>, which masks <code>dplyr::select</code>. If we were to load <code>dplyr</code> first, then <code>multilevel</code>, we would see the following:</p>
<pre><code>&gt; library(dplyr)
&gt; library(multilevel)
Loading required package: nlme

Attaching package: ‘nlme’

The following object is masked from ‘package:dplyr’:

    collapse

Loading required package: MASS

Attaching package: ‘MASS’

The following object is masked from ‘package:dplyr’:

    select</code></pre>
<p>Read in English, this says, “The multilevel package needs to load nlme (a mixed-effects package). Nlme has a function called ‘collapse’ that will now take precedence over ‘collapse’ in dplyr if you run <code>collapse()</code> in your session. Multilevel also needs the MASS package, so I’m loading it. The MASS package has a function called ‘select’ that now takes precedence over dplyr’s select function, so if you call <code>select()</code> in your session, you will be getting the MASS package function, not the dplyr one.”</p>
<p>To get around these problems, the easiest route is to load dplyr (and other tidyverse packages) last in the chain, giving them precedence over other packages. As you see above in the <code>p_load</code> call, we load <code>dplyr</code> last in the chain so that its select function is preferred over MASS. This is important because functions of the same name across packages may have completely different purposes and syntax!</p>
<p>The slightly harder, but more robust, route is always to use explicit namespace qualifiers with the <code>::</code> operator. If you use <code>dplyr::select</code> as the function call, you are explicitly telling R that you want dplyr’s select function, not some other package’s.</p>
<p>The two most common collisions are with <code>select</code> (MASS) and <code>summarize</code> (Hmisc). If you’re not sure which version of a function has taken precedence you can type the function name without parentheses. This will print the function source (which you can ignore). But take a look at the last line, which reveals where R ‘found’ the function in the search across loaded packages (based on their load order/precedence).</p>
<pre><code>&gt; select
function (obj) 
UseMethod("select")
&lt;bytecode: 0x93b18ebd8&gt;
&lt;environment: namespace:MASS&gt;</code></pre>
<p>If you were expecting that last line to read <code>&lt;environment: namespace:dplyr&gt;</code> (i.e.&nbsp;dplyr’s version), then you have a namespace problem to resolve!</p>
</section>
</section>
<section id="data-pipelines" class="level1">
<h1>Data pipelines</h1>
<p>The <code>tidyverse</code> paradigm encourages the use of so-called data pipelines when writing the syntax for a multi-step data transformation procedure. The pipe operator <code>%&gt;%</code> is provided by the <code>magrittr</code> package, which is loaded by <code>dplyr</code>. Data pipeline syntax is intended to provide a readable syntax for the order in which data operations are performed. You can think of this as a recipe for data wrangling. For example:</p>
<pre><code>1. Read data from the file: 'mydata.csv'
2. Rename SDATE to submission_date; rename ed to education
3. Only keep subject IDs above 10 (the first 9 were in-lab pilot subjects)
4. Drop the timestamp and survey_settings variables
5. Compute the log of income as a new variable called log_income
6. Arrange the data by ID, then submission_date (where each subject submitted many surveys)
7. Ensure that ID and submission_date are the left-most columns in the data</code></pre>
<p>We would write this out as a dplyr pipeline using the pipe operator <code>%&gt;%</code> to chain together data operations.</p>
<pre><code>dataset &lt;- read.csv("mydata.csv") %&gt;%
  rename(submission_date=SDATE, education=ed) %&gt;%
  filter(ID &lt; 10) %&gt;%
  select(-timestamp, -survey_settings) %&gt;%
  mutate(log_income = log(income)) %&gt;%
  arrange(ID, submission_date) %&gt;%
  select(ID, submission_date, everything())</code></pre>
<section id="use-of-this-reference-in-tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="use-of-this-reference-in-tidyverse">Use of ‘this’ reference in tidyverse</h2>
<p>Sometimes it is useful to refer to the current dataset or variable explicitly in tidyverse data wrangling syntax.</p>
<p>dplyr/magrittr tends to hide this from us for convenience, but it’s there under the hood.</p>
<p><code>iris %&gt;% filter(Sepal.Length &gt; 7)</code></p>
<p>is the same as</p>
<p><code>iris %&gt;% filter(., Sepal.Length &gt; 7)</code></p>
<p>So, <code>'.'</code> refers to the current dataset or variable (depending on context) in dplyr operations. And if you don’t specify where the <code>'.'</code> falls in your syntax, it will always be passed as the first argument to the downstream function.</p>
</section>
</section>
<section id="special-values-to-watch-out-for-in-data-wrangling" class="level1">
<h1>Special values to watch out for in data wrangling</h1>
<ul>
<li>NA: missing
<ul>
<li>na.rm=TRUE available in many functions</li>
<li>Also, see na.omit(), na.exclude(), na.fail(), na.pass()</li>
</ul></li>
<li>NULL: null set
<ul>
<li>Often used when something is undefined</li>
</ul></li>
<li>Inf: infinite</li>
<li>NaN: Not a number.
<ul>
<li>Result of an invalid computation, e.g., log(-1)</li>
</ul></li>
<li>warnings(): If R mentions a warning in data wrangling, make sure you’ve handled it or know its origin. <strong>Don’t just ignore these!</strong></li>
</ul>
</section>
<section id="dplyr-fundamentals" class="level1">
<h1>dplyr fundamentals</h1>
<p>The <code>dplyr</code> package is at the core of data wrangling in the <code>tidyverse</code>, providing a set of wrangling verbs that collectively form a coherent language for data transformations.</p>
<section id="overview-a-first-pass-through-an-nhanes-dataset" class="level2">
<h2 class="anchored" data-anchor-id="overview-a-first-pass-through-an-nhanes-dataset">Overview: a first pass through an NHANES dataset</h2>
<p>To learn <code>dplyr</code>, let’s start with a survey from the National Health and Nutrition Examination Survey (NHANES) dataset. These data are provided in the <code>nhanesA</code> package. We’ll start by looking at a couple of basic demographic variables.</p>
<p><strong>NHANES variables used below (from DEMO_D and BMX_D):</strong></p>
<ul>
<li><code>SEQN</code>: respondent ID</li>
<li><code>RIAGENDR</code>: gender (coded numeric in raw NHANES)</li>
<li><code>RIDAGEYR</code>: age in years</li>
<li><code>DMDHREDU</code>: education level</li>
<li><code>BMXWT</code>: weight (kg)</li>
<li><code>BMXARML</code>: upper arm length (cm)</li>
<li><code>BMXTHICR</code>: thigh circumference (cm)</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># demographics: note that this code relies on functions in the nhanesA package, which</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   is useful for working with NHANES data, but is not a focus of this workshop per se.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>demo_d <span class="ot">&lt;-</span> <span class="fu">nhanes</span>(<span class="st">'DEMO_D'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>demo_d_vars  <span class="ot">&lt;-</span> <span class="fu">nhanesTableVars</span>(<span class="st">'DEMOGRAPHICS'</span>, <span class="st">'DEMO_D'</span>, <span class="at">namesonly=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># translate numeric codes into factors by using the nhanes lookup/codebook functions</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>demo_d <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">nhanesTranslate</span>(<span class="st">'DEMO_D'</span>, demo_d_vars, <span class="at">data=</span>demo_d))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Translated columns: AIALANG DMDBORN DMDCITZN DMDEDUC2 DMDEDUC3 DMDHRBRN DMDHREDU DMDHRGND DMDHRMAR DMDHSEDU DMDMARTL DMDSCHOL DMDYRSUS DMQMILIT FIAINTRP FIALANG FIAPROXY INDFMINC INDHHINC MIAINTRP MIALANG MIAPROXY RIAGENDR RIDEXMON RIDEXPRG RIDRETH1 RIDSTATR SDDSRVYR SIAINTRP SIALANG SIAPROXY</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr pipeline</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>demo_d <span class="ot">&lt;-</span> demo_d <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>INDHHINC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Over $20,000"</span>, <span class="st">"Under $20,000"</span>, <span class="st">"Refused"</span>, <span class="st">"Don't know"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">%&gt;%</span> <span class="co"># drop unused factor levels from the data.frame</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># case_when() is a vectorized if/else ladder for many conditions</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">income_num =</span> <span class="fu">case_when</span>( <span class="co"># convert range-based factor labels to midpoint numbers</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$     0 to $ 4,999"</span> <span class="sc">~</span> <span class="dv">2500</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$ 5,000 to $ 9,999"</span> <span class="sc">~</span> <span class="dv">7500</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$10,000 to $14,999"</span> <span class="sc">~</span> <span class="dv">12500</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$15,000 to $19,999"</span> <span class="sc">~</span> <span class="dv">17500</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$20,000 to $24,999"</span> <span class="sc">~</span> <span class="dv">22500</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$25,000 to $34,999"</span> <span class="sc">~</span> <span class="dv">30000</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$35,000 to $44,999"</span> <span class="sc">~</span> <span class="dv">40000</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$45,000 to $54,999"</span> <span class="sc">~</span> <span class="dv">50000</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$55,000 to $64,999"</span> <span class="sc">~</span> <span class="dv">60000</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$65,000 to $74,999"</span> <span class="sc">~</span> <span class="dv">70000</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    INDHHINC <span class="sc">==</span> <span class="st">"$75,000 and Over"</span> <span class="sc">~</span> <span class="dv">80000</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#load body (biometric) measures</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>bmx_d <span class="ot">&lt;-</span> <span class="fu">nhanes</span>(<span class="st">'BMX_D'</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>bmx_d_vars  <span class="ot">&lt;-</span> <span class="fu">nhanesTableVars</span>(<span class="st">'EXAM'</span>, <span class="st">'BMX_D'</span>, <span class="at">namesonly=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>bmx_d <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">nhanesTranslate</span>(<span class="st">'BMX_D'</span>, bmx_d_vars, <span class="at">data=</span>bmx_d))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Translated columns: BMDSTATS BMIARMC BMIARML BMICALF BMIHT BMILEG BMIRECUM BMISUB BMITHICR BMITRI BMIWAIST BMIWT</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the education demographics variable with the biometric data, joining on the SEQN column (basically an ID)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>bmx_d <span class="ot">&lt;-</span> demo_d <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, DMDHREDU) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(bmx_d, <span class="at">by=</span><span class="st">"SEQN"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="group_by-summarize" class="level2">
<h2 class="anchored" data-anchor-id="group_by-summarize">group_by + summarize</h2>
<p>Let’s summarize the mean household income (<code>income_num</code>), converted from categories in <code>INDHHINC</code>) by highest level of education completed (<code>DMDHREDU</code>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>demo_d <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DMDHREDU) <span class="sc">%&gt;%</span> <span class="co"># divide dataset into separate compartments by education level</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n=</span><span class="fu">n</span>(), <span class="co"># number of observations</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">m_income=</span><span class="fu">mean</span>(income_num, <span class="at">na.rm=</span>T), </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_income=</span><span class="fu">sd</span>(income_num, <span class="at">na.rm=</span>T)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHREDU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">m_income</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd_income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Less Than 9th Grade</td>
<td style="text-align: right;">1173</td>
<td style="text-align: right;">28024</td>
<td style="text-align: right;">18489</td>
</tr>
<tr class="even">
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: right;">1626</td>
<td style="text-align: right;">31318</td>
<td style="text-align: right;">21584</td>
</tr>
<tr class="odd">
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: right;">2317</td>
<td style="text-align: right;">39400</td>
<td style="text-align: right;">23422</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: right;">2664</td>
<td style="text-align: right;">48137</td>
<td style="text-align: right;">25326</td>
</tr>
<tr class="odd">
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: right;">1768</td>
<td style="text-align: right;">63785</td>
<td style="text-align: right;">21816</td>
</tr>
<tr class="even">
<td style="text-align: left;">Refused</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">25000</td>
<td style="text-align: right;">12624</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Don't know</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">20900</td>
<td style="text-align: right;">15760</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">44623</td>
<td style="text-align: right;">24849</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that <code>summarize</code> removes a single level of grouping in the <code>group_by</code> process. Here, we only have one grouping variable, <code>DMDHREDU</code>, so the output of <code>summarize</code> will be ‘ungrouped.’</p>
</section>
<section id="grouped-summaries-of-several-variables" class="level2">
<h2 class="anchored" data-anchor-id="grouped-summaries-of-several-variables">Grouped summaries of several variables</h2>
<p>What if I want to have means and SDs for several continuous variables grouped by highest education? Let’s look specifically at the weight (<code>BMXWT</code>), upper arm length (<code>BMXARML</code>), and thigh circumference (<code>BMXTHICR</code>) measurements. The combination of <code>summarize</code> and <code>across</code> provide functionality to specify several variables using the <code>.cols</code> argument of <code>across</code> and potentially several summary functions by passing them in a named <code>list</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bmx_d <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DMDHREDU) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(BMXWT, BMXARML, BMXTHICR), </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">m=</span><span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm=</span>T), <span class="at">sd=</span><span class="sc">~</span><span class="fu">sd</span>(.x, <span class="at">na.rm=</span>T))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHREDU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWT_m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWT_sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARML_m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARML_sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTHICR_m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTHICR_sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Less Than 9th Grade</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">7.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">8.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7.9</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">8.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">8.65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">7.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">Refused</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Don't know</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">11.5</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">7.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">7.73</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Let’s slow this down:</p>
<section id="group_by-verb" class="level3">
<h3 class="anchored" data-anchor-id="group_by-verb">group_by verb</h3>
<pre><code>survey %&gt;% group_by(DMDHREDU)</code></pre>
<p>This tells <code>dplyr</code> to divide the <code>bmx_d</code> (NHANES biometric measurements) data into a set of smaller <code>data.frame</code> objects, one per level of <code>DMDHREDU</code>. Internally, this looks something like the output below. After this division of the dataset into chunks, <code>summarize</code> will work on each chunk individually.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`Less Than 9th Grade`
   SEQN            DMDHREDU                    BMDSTATS BMXWT
1 31137 Less Than 9th Grade          Other partial exam    80
2 31157 Less Than 9th Grade Complete data for age group    42
3 31169 Less Than 9th Grade Complete data for age group    22
4 31175 Less Than 9th Grade Complete data for age group    86

$`9-11th Grade (Includes 12th grade with no diploma)`
   SEQN                                           DMDHREDU
1 31128 9-11th Grade (Includes 12th grade with no diploma)
2 31133 9-11th Grade (Includes 12th grade with no diploma)
3 31145 9-11th Grade (Includes 12th grade with no diploma)
4 31148 9-11th Grade (Includes 12th grade with no diploma)
                     BMDSTATS BMXWT
1 Complete data for age group    40
2 Complete data for age group    45
3 Complete data for age group    40
4 Complete data for age group    52

$`High School Grad/GED or equivalent`
   SEQN                           DMDHREDU                    BMDSTATS BMXWT
1 31127 High School Grad/GED or equivalent Complete data for age group    10
2 31139 High School Grad/GED or equivalent          Other partial exam    74
3 31140 High School Grad/GED or equivalent Complete data for age group    42
4 31143 High School Grad/GED or equivalent Complete data for age group    76

$`Some College or AA degree`
   SEQN                  DMDHREDU                    BMDSTATS BMXWT
1 31129 Some College or AA degree Complete data for age group    75
2 31130 Some College or AA degree  No body measures exam data    NA
3 31138 Some College or AA degree Complete data for age group    14
4 31142 Some College or AA degree          Other partial exam    80

$`College Graduate or above`
   SEQN                  DMDHREDU                    BMDSTATS BMXWT
1 31131 College Graduate or above          Other partial exam    75
2 31132 College Graduate or above Complete data for age group    70
3 31135 College Graduate or above Complete data for age group    10
4 31141 College Graduate or above Complete data for age group    60

$Refused
   SEQN DMDHREDU                             BMDSTATS BMXWT
1 33385  Refused          Complete data for age group    78
2 35296  Refused Partial:  Height and weight obtained    38
3 37761  Refused          Complete data for age group    67
4 40762  Refused Partial:  Height and weight obtained    99

$`Don't know`
   SEQN   DMDHREDU                    BMDSTATS BMXWT
1 31546 Don't know          Other partial exam    78
2 32106 Don't know Complete data for age group    12
3 32626 Don't know Complete data for age group    64
4 32648 Don't know Complete data for age group    85</code></pre>
</div>
</div>
</section>
<section id="summarize-across" class="level3">
<h3 class="anchored" data-anchor-id="summarize-across">summarize + across</h3>
<p>The <code>summarize</code> function transforms a dataset that has many rows to a dataset that has a <strong>single</strong> row per grouping unit. If you do not use <code>group_by</code>, <code>summarize</code> will yield an overall summary statistic in the entire dataset. For example, to get the mean and SD of household income in NHANES, irrespective of education level or other categorical moderators, we could just use a simple <code>summarize</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>demo_d <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">m_income=</span><span class="fu">mean</span>(income_num, <span class="at">na.rm=</span>T), </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_income=</span><span class="fu">sd</span>(income_num, <span class="at">na.rm=</span>T)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">m_income</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd_income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">43590</td>
<td style="text-align: right;">25726</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>But because we used <code>group_by(DMDHREDU)</code> above, we got unique summaries of the variables at each level of education.</p>
<p>The <code>across</code> function accepts two primary arguments. First, we specify a set of variables (the <code>.cols</code> argument) that we wish to summarize in the same way (i.e., compute the same summary statistics). Second, we specify which statistics we wish to compute (the <code>.fns</code> argument). In our case, the syntax was:</p>
<pre><code>dplyr::summarize(
    across(c(BMXWT, BMXARML, BMXTHICR), 
           list(m=~mean(.x, na.rm=T), sd=~sd(.x, na.rm=T)))
)</code></pre>
<p>The <code>c()</code> function specifies a vector of unquoted variable names in the dataset we wish to summarize, separated by commas. Note that any <code>tidyselect</code> operator for selecting columns will work. This includes <code>starts_with</code>, <code>ends_with</code>, <code>matches</code>, and others. For details, see <code>?dplyr_tidy_select</code>.</p>
<p>The <code>list()</code> here asks <code>dplyr</code> to run each function in the list against each variables in the <code>.cols</code> specification. Here, this means that dplyr will compute the mean and SD of each variable in the <code>.cols</code> argument at <em>each level</em> of education completed (the <code>group_by</code> basis). The names of the list elements (left side) — here, <code>m</code> and <code>sd</code> — become the suffixes added for each variable. The value of the element (right side) — here, <code>mean</code> and <code>sd</code> — are the functions that should be used to compute a summary statistic (they should return one number per grouped variable).</p>
<p>Note that the column names that result from an <code>across</code> operation can be modified using the <code>.names</code> argument. The default is to suffix the variable name with the names of the functions list, preceded by an underscore (e.g., <code>income_m</code>).</p>
<p><strong>Passing arguments to summary functions</strong></p>
<p>Notice how we passed <code>na.rm=TRUE</code> to the mean function within the list. This tells the mean to ignore missing (<code>NA</code>) values when computing the mean (i.e., mean of the non-missing numbers). In general, the dplyr syntax using what they call “lambdas” (starting with <code>~</code>) is the clearest way to control the arguments passed to each function. Here is a simple definition of a lambda in <em>R</em>:</p>
<p><code>~ mean(.x, na.rm=TRUE)</code></p>
<p>The <code>.x</code> refers to the current variable being used within a dplyr data wrangling operation. This is in contrast to <code>.</code>, which generally refers to the current dataset.</p>
<p>If you don’t need to pass arguments to the functions in an <code>across()</code> operation, you can just state the function name:</p>
<pre><code>dplyr::summarize(
    across(c(BMXWT, BMXARML, BMXTHICR), 
           list(m=mean, sd=sd))
)</code></pre>
</section>
</section>
<section id="making-a-summarize-pipeline-even-more-beautiful" class="level2">
<h2 class="anchored" data-anchor-id="making-a-summarize-pipeline-even-more-beautiful">Making a summarize pipeline even more beautiful</h2>
<p>We can also make the output more beautiful using tidying techniques we’ve already seen in the <code>tidyr</code> tutorial. Remember that <code>R</code> is all about programming for data science. In particular, notice that we have some columns that are means and others that are SDs.</p>
<p>We can just extend our data pipeline a bit. The <code>extract</code> function from <code>tidyr</code> here is like <code>separate</code>, but with a bit more oomph using regular expressions. This is a more intermediate topic, but there is a useful tutorial here: <a href="http://www.regular-expressions.info/tutorial.html" class="uri">http://www.regular-expressions.info/tutorial.html</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bmx_d <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DMDHREDU) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(BMXWT, BMXARML, BMXTHICR), </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">m=</span><span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm=</span>T), <span class="at">sd=</span><span class="sc">~</span><span class="fu">sd</span>(.x, <span class="at">na.rm=</span>T))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>   <span class="co"># combine m and sd statistics (notice how you can add comments inline within a pipeline?)</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>DMDHREDU, <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># divide income_m into income and m</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#extract(col=Measure, into=c("bio_measure", "statistic"), regex=("(.*)_(.*)$")) %&gt;% </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col=</span>Measure, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"bio_measure"</span>, <span class="st">"statistic"</span>), <span class="at">sep=</span><span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>statistic, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span> (bio_measure, DMDHREDU) <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHREDU</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">bio_measure</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">m</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Less Than 9th Grade</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">7.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">8.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">7.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Refused</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2.47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Don't know</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">11.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BMXARML</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">7.62</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Less Than 9th Grade</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">7.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">8.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">8.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">8.65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">7.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">Refused</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Don't know</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">7.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BMXTHICR</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">7.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Less Than 9th Grade</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">30.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">33.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">32.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">32.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">31.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Refused</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">25.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Don't know</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">36.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">BMXWT</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">29.12</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="arrange-order-observations" class="level3">
<h3 class="anchored" data-anchor-id="arrange-order-observations">arrange: order observations</h3>
<p>Toward the end of the pipeline above, we see:</p>
<pre><code>arrange (bio_measure, DMDHREDU) %&gt;%</code></pre>
<p>The <code>arrange</code> verb in dplyr requests that observations be sorted according to one or more variables. Here, we ask for the dataset to be sorted by bio_measure (biometric measure, such as weight) first, then by education level within that measure. The <code>arrange</code> verb sorts observations in <strong>ascending</strong> order (low to high) by default, but data can be sorted in descending order using the <code>desc()</code> function:</p>
<pre><code>arrange(bio_measure, desc(DMDHREDU)) %&gt;%</code></pre>
<p>This would sort by highest to lowest education level within each measure (<code>bio_measure</code>), where the bio_measures are still in ascending (alphabetical) order</p>
</section>
</section>
</section>
<section id="examining-a-more-complex-multilevel-dataset-using-dplyr" class="level1">
<h1>Examining a more complex multilevel dataset using dplyr</h1>
<p>Let’s examine the univbct data, which contains longitudinal observations of job satisfaction, commitment, and readiness to deploy. From the documentation <code>?univbct</code>:</p>
<pre><code>This data set contains the complete data set used in Bliese and Ployhart (2002). The data is longitudinal data converted to univariate (i.e., stacked) form. Data were collected at three time points. A data frame with 22 columns and 1485 observations from 495 individuals.</code></pre>
<p>We have 1485 observations of military personnel nested within companies, which are nested within batallions: <a href="https://en.wikipedia.org/wiki/Battalion" class="uri">https://en.wikipedia.org/wiki/Battalion</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(univbct, <span class="at">package=</span><span class="st">"multilevel"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(univbct)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1485 obs. of  22 variables:
 $ BTN    : num  1022 1022 1022 1004 1004 ...
 $ COMPANY: Factor w/ 8 levels "A","B","C","D",..: 6 6 6 4 4 4 2 2 2 2 ...
 $ MARITAL: num  1 1 1 4 4 4 2 2 2 2 ...
 $ GENDER : num  1 1 1 1 1 1 1 1 1 1 ...
 $ HOWLONG: num  2 2 2 0 0 0 0 0 0 1 ...
 $ RANK   : num  12 12 12 13 13 13 15 15 15 14 ...
 $ EDUCATE: num  2 2 2 2 2 2 2 2 2 2 ...
 $ AGE    : num  20 20 20 24 24 24 24 24 24 23 ...
 $ JOBSAT1: num  1.67 1.67 1.67 3.67 3.67 ...
 $ COMMIT1: num  1.67 1.67 1.67 1.67 1.67 ...
 $ READY1 : num  2.75 2.75 2.75 3 3 3 3.75 3.75 3.75 2.5 ...
 $ JOBSAT2: num  1 1 1 4 4 ...
 $ COMMIT2: num  1.67 1.67 1.67 1.33 1.33 ...
 $ READY2 : num  1 1 1 2 2 2 3.75 3.75 3.75 3.25 ...
 $ JOBSAT3: num  3 3 3 4 4 4 4 4 4 3 ...
 $ COMMIT3: num  3 3 3 1.33 1.33 ...
 $ READY3 : num  3 3 3 1.75 1.75 1.75 1.75 1.75 1.75 3 ...
 $ TIME   : num  0 1 2 0 1 2 0 1 2 0 ...
 $ JSAT   : num  1.67 1 3 3.67 4 ...
 $ COMMIT : num  1.67 1.67 3 1.67 1.33 ...
 $ READY  : num  2.75 1 3 3 2 1.75 3.75 3.75 1.75 2.5 ...
 $ SUBNUM : num  1 1 1 2 2 2 3 3 3 4 ...</code></pre>
</div>
</div>
<p>Let’s enact the core ‘verbs’ of dplyr to understand and improve the structure of these data.</p>
<section id="filter-obtaining-observations-rows-based-on-some-criteria" class="level2">
<h2 class="anchored" data-anchor-id="filter-obtaining-observations-rows-based-on-some-criteria">filter: obtaining observations (rows) based on some criteria</h2>
<p><em>Objective</em>: Retain only men in company A</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>COMPANY<span class="ot">=</span><span class="st">"A"</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>COMPANY <span class="ot">&lt;-</span> <span class="st">"A"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>company_A_men <span class="ot">&lt;-</span> <span class="fu">filter</span>(univbct, COMPANY<span class="sc">==</span><span class="st">"A"</span> <span class="sc">&amp;</span> GENDER<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print 10 observations at random to check the accuracy of the filter</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#p=11 just shows the first 11 columns to keep it on one page for formatting</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>company_A_men <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_table</span>(<span class="at">p=</span><span class="dv">11</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BTN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">COMPANY</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MARITAL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GENDER</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">HOWLONG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RANK</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">EDUCATE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AGE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JOBSAT1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">READY1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">822</td>
<td style="text-align: right;">4042</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">821</td>
<td style="text-align: right;">4042</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">624</td>
<td style="text-align: right;">299</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">556</td>
<td style="text-align: right;">144</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">3.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">529</td>
<td style="text-align: right;">3066</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">453</td>
<td style="text-align: right;">299</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">2.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">55</td>
<td style="text-align: right;">104</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">1234</td>
<td style="text-align: right;">3066</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">618</td>
<td style="text-align: right;">4042</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">2.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">592</td>
<td style="text-align: right;">1022</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>Objective</em>: Count how many people are in companies A and B</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(univbct, COMPANY <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>)) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 750</code></pre>
</div>
</div>
<p><em>Objective</em>: What about counts by company and battalion?</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>univbct <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(BTN, COMPANY) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n=</span><span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">BTN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">COMPANY</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">66</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">HHC</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: right;">104</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104</td>
<td style="text-align: left;">HHC</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">124</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">144</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: right;">299</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: right;">299</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: right;">299</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">27</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># N.B. The same result could be obtained with count(BTN, COMPANY) alone.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  This combines the group_by and tally functions</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="select-choose-variables-columns-based-on-some-criteria" class="level2">
<h2 class="anchored" data-anchor-id="select-choose-variables-columns-based-on-some-criteria">select: choose variables (columns) based on some criteria</h2>
<p>Let’s start by keeping only the three core dependent variables over time: jobsat, commit, ready. Keep SUBNUM as well for unique identification.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dvs_only <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SUBNUM, JOBSAT1, JOBSAT2, JOBSAT3, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                COMMIT1, COMMIT2, COMMIT3, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                READY1, READY2, READY3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>If you have many variables of a similar name, you might try <code>starts_with()</code>. Note in this case that it brings in “READY”, too. Note that you can mix different selection mechanisms within select. Look at the cheatsheet.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dvs_only <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SUBNUM, <span class="fu">starts_with</span>(<span class="st">"JOBSAT"</span>), <span class="fu">starts_with</span>(<span class="st">"COMMIT"</span>), <span class="fu">starts_with</span>(<span class="st">"READY"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Other selection mechanisms:</p>
<ul>
<li><code>contains</code>: variable name contains a literal string</li>
<li><code>starts_with</code>: variable names start with a string</li>
<li><code>ends_with</code>: variable names end with a string</li>
<li><code>num_range</code>: variables that have a common prefix (e.g., ‘reasoning’) and a numeric range (e.g., 1-20)</li>
<li><code>matches</code>: variable name matches a regular expression</li>
<li><code>one_of</code>: variable is one of the elements in a character vector. Example: select(one_of(c(“A”, “B”)))</li>
</ul>
<p>See <code>?select_helpers</code> for more details.</p>
</section>
<section id="select-filter-zooming-in-on-specific-observations-and-variables" class="level2">
<h2 class="anchored" data-anchor-id="select-filter-zooming-in-on-specific-observations-and-variables">select + filter: zooming in on specific observations and variables</h2>
<p>Note that <code>select</code> and <code>filter</code> can be combined to subset both observations and variables of interest.</p>
<p>For example, look at readiness to deploy in battalion 299 only:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>univbct <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(BTN<span class="sc">==</span><span class="dv">299</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SUBNUM, READY1, READY2, READY3) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n=</span><span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SUBNUM</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">READY1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">READY2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">READY3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">1.2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><code>select</code> is also useful for dropping variables that are not of interest using a kind of subtraction syntax.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>nojobsat <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"JOBSAT"</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(nojobsat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "BTN"     "COMPANY" "MARITAL" "GENDER"  "HOWLONG" "RANK"    "EDUCATE"
 [8] "AGE"     "COMMIT1" "READY1"  "COMMIT2" "READY2"  "COMMIT3" "READY3" 
[15] "TIME"    "JSAT"    "COMMIT"  "READY"   "SUBNUM" </code></pre>
</div>
</div>
</section>
<section id="mutate-add-one-or-more-variables-that-are-a-function-of-other-variables" class="level2">
<h2 class="anchored" data-anchor-id="mutate-add-one-or-more-variables-that-are-a-function-of-other-variables">mutate: add one or more variables that are a function of other variables</h2>
<p>(Row-wise) mean of commit scores over waves. Note how you can used <code>select()</code> within a mutate to run a function on a subset of the data.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>univbct <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">commitmean=</span><span class="fu">rowMeans</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(., COMMIT1, COMMIT2, COMMIT3)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Mutate can manipulate several variables in one call. Here, mean center any variable that starts with COMMIT and add the suffix <code>_cm</code> for clarity. Also compute the percentile rank for each of these columns, with _pct as suffix. Note the use of the <code>starts_with</code> function here within the <code>across()</code>. This operates identically to <code>select</code>, but in the context of a summary or mutation operation on specific variables. See <code>?select_helpers</code> for details.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>meancent <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { x <span class="sc">-</span> <span class="fu">mean</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>) } <span class="co">#simple worker function to mean center a variable</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>univbct <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"COMMIT"</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>), <span class="fu">list</span>(<span class="at">cm=</span>meancent, <span class="at">pct=</span>percent_rank)))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>univbct <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"COMMIT"</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n=</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT1_cm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT1_pct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT2_cm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT2_pct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT3_cm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT3_pct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT_cm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT_pct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">-1.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-1.80</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-1.87</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">-1.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-1.80</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-1.87</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">-1.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-1.80</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">-1.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.13</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-2.20</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-1.87</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">-1.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.13</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-2.20</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.21</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">-1.95</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.13</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-2.20</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-2.21</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="even">
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">0.30</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="arrange-reorder-observations-in-specific-order" class="level2">
<h2 class="anchored" data-anchor-id="arrange-reorder-observations-in-specific-order">arrange: reorder observations in specific order</h2>
<p>Order data by ascending battalion, company, then subnum</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>univbct <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BTN, COMPANY, SUBNUM)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Descending sort: descending battalion, ascending company, ascending subnum</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>univbct <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(BTN), COMPANY, SUBNUM)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="a-more-realistic-example-preparation-for-multilevel-analysis" class="level2">
<h2 class="anchored" data-anchor-id="a-more-realistic-example-preparation-for-multilevel-analysis">A more realistic example: preparation for multilevel analysis</h2>
<p>In MLM, one strategy for disentangling within- versus between-person effects is to include both within-person-centered variables and person means in the model (Curran &amp; Bauer, 2011).</p>
<p>We can achieve this easily for our three DVs here using a single pipeline that combines tidying and mutation. Using <code>-1</code> as the <code>sep</code> argument to <code>separate</code> splits the string at the second-to-last position (i.e., starting at the right).</p>
<p>For reshaping to work smoothly, we need a unique identifier for each row. Also, <code>univbct</code> is stored in a dangerously untidy format in which variables with suffix 1-3 indicate a ‘wide format’, but the data is <em>also</em> in long format under variables such as ‘JSAT’ and ‘COMMIT.’ In other words, there is a peculiar redundancy in the data that is altogether confusing.</p>
<p>Take a look:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>univbct <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SUBNUM, <span class="fu">starts_with</span>(<span class="st">"JOBSAT"</span>), JSAT) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n=</span><span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SUBNUM</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JOBSAT1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JOBSAT2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JOBSAT3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JSAT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">319</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">320</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">2.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">321</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">397</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">398</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">399</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">4.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">523</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">524</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">525</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">616</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">617</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">618</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">4.3</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We first need to eliminate this insanity. Group by subject number and retain only the first row (i.e., keep the wide version).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>univbct <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SUBNUM) <span class="sc">%&gt;%</span> <span class="co"># split into separate groups for each subject</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># only retain the first row of each subject</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>JSAT, <span class="sc">-</span>COMMIT, <span class="sc">-</span>READY) <span class="sc">%&gt;%</span> <span class="co"># drop redundant columns</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="co"># remove grouping from data structure (we are done with group-based wrangling)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>First, let’s get the data into a conventional format (long) for MLM (e.g., using <code>lmer</code>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>forMLM <span class="ot">&lt;-</span> univbct <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SUBNUM, JOBSAT1, JOBSAT2, JOBSAT3, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                COMMIT1, COMMIT2, COMMIT3, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                READY1, READY2, READY3) <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot everything but SUBNUM</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"key"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>, <span class="at">cols=</span><span class="sc">-</span>SUBNUM) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -1 splits at the last character of the variable name</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col=</span><span class="st">"key"</span>, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">"occasion"</span>), <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">occasion=</span><span class="fu">as.numeric</span>(occasion))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Now, let’s perform the centering described above. You could do this in one pipeline – I just separated things here for conceptual clarity.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>forMLM <span class="ot">&lt;-</span> forMLM <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(SUBNUM) <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(COMMIT, JOBSAT, READY), <span class="fu">list</span>(<span class="at">wic=</span>meancent, <span class="at">pm=</span>mean))) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>forMLM <span class="sc">%&gt;%</span> <span class="fu">kable_table</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SUBNUM</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">occasion</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JOBSAT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">READY</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT_wic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">COMMIT_pm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JOBSAT_wic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">JOBSAT_pm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">READY_wic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">READY_pm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">103</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">103</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">-0.50</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">129</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">129</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">129</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">171</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">171</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">171</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">202</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">-1.22</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">3.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="reference-rows-columns-and-groups-in-dplyr" class="level1">
<h1>Reference: Rows, columns, and groups in dplyr</h1>
<p>Most dplyr workflows can be organized around three kinds of operations: selecting rows, selecting columns, and operating within groups.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="ot">&lt;-</span> <span class="fu">nhanes</span>(<span class="st">'DEMO_D'</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>bmx_q <span class="ot">&lt;-</span> <span class="fu">nhanes</span>(<span class="st">'BMX_D'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Rows:</strong> keep or reorder observations</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RIDAGEYR <span class="sc">&gt;</span> <span class="dv">25</span>, RIAGENDR <span class="sc">==</span> <span class="st">"Male"</span>) <span class="sc">%&gt;%</span>  <span class="co"># filter rows by logical and: over 25 and male </span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(RIDAGEYR)) <span class="sc">%&gt;%</span>                <span class="co"># order rows by descending age</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(DMDHREDU, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>   <span class="co"># keep first row per education level for inspection</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEQN, RIDAGEYR, RIAGENDR, DMDHREDU) <span class="sc">%&gt;%</span> <span class="co"># subset down to a few variables of interest</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Watch out for attempts to refer to variables you have 'selected out' earlier in the pipeline.</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here, DMDHRBRN isn't in the select statement above, so we can't use it in a downstream mutate call</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   in_us = if_else(DMDHRBRN == "Born in 50 US States or Washington, DC", TRUE, FALSE)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) %&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEYR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIAGENDR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHREDU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31447</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">High School Grad/GED or equivalent</td>
</tr>
<tr class="even">
<td style="text-align: right;">31558</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31610</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Some College or AA degree</td>
</tr>
<tr class="even">
<td style="text-align: right;">32444</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Less Than 9th Grade</td>
</tr>
<tr class="odd">
<td style="text-align: right;">32455</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">College Graduate or above</td>
</tr>
<tr class="even">
<td style="text-align: right;">35818</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">39906</td>
<td style="text-align: right;">78</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Refused</td>
</tr>
<tr class="even">
<td style="text-align: right;">31634</td>
<td style="text-align: right;">67</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Don't know</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Row filters can also use <code>if_any()</code> and <code>if_all()</code> across multiple columns:</p>
<p>Here, using <code>if_any</code>, we find observations where weight (<code>BMXWT</code> in kg), arm length (<code>BMXARML</code> in cm), or thigh circumference (<code>BMXTHICR</code> in cm) is greater than 60 (setting aside the different units of measurement).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>bmx_q <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_any</span>(<span class="fu">c</span>(BMXWT, BMXARML, BMXTHICR), <span class="sc">~</span> .x <span class="sc">&gt;</span> <span class="dv">60</span>)) <span class="sc">%&gt;%</span>  <span class="co"># any column above 60</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="co"># get a random sample of 5 rows</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMDSTATS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIWT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXRECUM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIRECUM</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMIHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIHT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXBMI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXLEG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMILEG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXCALF</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMICALF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARML</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIARML</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARMC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIARMC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWAIST</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIWAIST</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTHICR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMITHICR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTRI</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMITRI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXSUB</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMISUB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31379</td>
<td style="text-align: left;">Other partial exam</td>
<td style="text-align: right;">94</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">166</td>
<td style="text-align: left;">Not straight</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">120</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">55</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Exceeds capacity</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Could not obtain</td>
</tr>
<tr class="even">
<td style="text-align: right;">33662</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">76</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">178</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">51</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">33941</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">164</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">96</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">37190</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">90</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">170</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">104</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">16.2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">28</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40684</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">84</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">176</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">98</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">49</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">9.6</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">28</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>By comparison, here are rows where <em>all three</em> of these are greater than 30, using <code>if_all</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>bmx_q <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">c</span>(BMXWT, BMXARML, BMXTHICR), <span class="sc">~</span> .x <span class="sc">&gt;</span> <span class="dv">30</span>)) <span class="sc">%&gt;%</span>  <span class="co"># all columns above 30</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMDSTATS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIWT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXRECUM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIRECUM</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMIHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIHT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXBMI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXLEG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMILEG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXCALF</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMICALF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARML</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIARML</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARMC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIARMC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWAIST</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIWAIST</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTHICR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMITHICR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTRI</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMITRI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXSUB</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMISUB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">35771</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">67</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">181</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">73</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">49</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">34224</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">178</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">106</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">15.8</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">39094</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">158</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">74</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">12.8</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">37685</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">113</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">194</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">43</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">108</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">17.4</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">35.0</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">36170</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">173</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">27</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">11.2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">8.8</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note: <code>filter()</code> drops rows where the condition is <code>NA</code>, so include <code>is.na()</code> checks if you want to keep missing values.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>bmx_q <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(BMXWT) <span class="sc">|</span> BMXWT <span class="sc">&gt;</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span>  <span class="co"># keep missing weights or weights &gt; 60</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMDSTATS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIWT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXRECUM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIRECUM</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMIHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIHT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXBMI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXLEG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMILEG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXCALF</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMICALF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARML</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIARML</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARMC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIARMC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWAIST</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMIWAIST</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTHICR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMITHICR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTRI</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMITRI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXSUB</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BMISUB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31129</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">75</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">168</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">43</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">98</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: left;">No body measures exam data</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31131</td>
<td style="text-align: left;">Other partial exam</td>
<td style="text-align: right;">75</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">156</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">96</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">54</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Exceeds capacity</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Could not obtain</td>
</tr>
<tr class="even">
<td style="text-align: right;">31132</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">168</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">96</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31134</td>
<td style="text-align: left;">Complete data for age group</td>
<td style="text-align: right;">102</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">182</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">43</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">43</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">117</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">50</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">31137</td>
<td style="text-align: left;">Other partial exam</td>
<td style="text-align: right;">80</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">170</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">89</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Could not obtain</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You can also take slices directly:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(RIDAGEYR, <span class="at">n =</span> <span class="dv">3</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>  <span class="co"># top 3 rows by age</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SDDSRVYR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDSTATR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDEXMON</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIAGENDR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEYR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEMN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEEX</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDRETH1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMQMILIT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDBORN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDCITZN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDYRSUS</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDEDUC3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDEDUC2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDSCHOL</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDMARTL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDHHSIZ</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDFMSIZ</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">INDHHINC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">INDFMINC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">INDFMPIR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDEXPRG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRGND</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDHRAGE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRBRN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHREDU</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRMAR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHSEDU</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AIALANG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTINT2YR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTMEC2YR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDMVPSU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDMVSTRA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31130</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">29961</td>
<td style="text-align: right;">34031</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="even">
<td style="text-align: right;">31149</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">$ 0 to $ 4,999</td>
<td style="text-align: left;">$ 0 to $ 4,999</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">23813</td>
<td style="text-align: right;">25998</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31297</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Born Elsewhere</td>
<td style="text-align: left;">Not a citizen of the US</td>
<td style="text-align: left;">50 years or more</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">High School Grad/GED or Equivalent</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">$75,000 and Over</td>
<td style="text-align: left;">$75,000 and Over</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: left;">Divorced</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">33863</td>
<td style="text-align: right;">36880</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">46</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Or take the first few rows in a group with <code>slice_head()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RIAGENDR) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SDDSRVYR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDSTATR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDEXMON</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIAGENDR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEYR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEMN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEEX</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDRETH1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMQMILIT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDBORN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDCITZN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDYRSUS</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDEDUC3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDEDUC2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDSCHOL</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDMARTL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDHHSIZ</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDFMSIZ</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">INDHHINC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">INDFMINC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">INDFMPIR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDEXPRG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRGND</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDHRAGE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRBRN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHREDU</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRMAR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHSEDU</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AIALANG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTINT2YR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTMEC2YR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDMVPSU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDMVSTRA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31127</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: left;">Married</td>
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">6435</td>
<td style="text-align: right;">6571</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="even">
<td style="text-align: right;">31129</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">190</td>
<td style="text-align: left;">Non-Hispanic Black</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">10th Grade</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">In school</td>
<td style="text-align: left;">Never married</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">$65,000 to $74,999</td>
<td style="text-align: left;">$65,000 to $74,999</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">Married</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">5317</td>
<td style="text-align: right;">5587</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31128</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">November 1 through April 30</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">132</td>
<td style="text-align: left;">Non-Hispanic Black</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">4th Grade</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">In school</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">$45,000 to $54,999</td>
<td style="text-align: left;">$20,000 to $24,999</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: left;">SP not pregnant at exam</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">9082</td>
<td style="text-align: right;">8987</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">29961</td>
<td style="text-align: right;">34031</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">46</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Columns:</strong> choose or reshape variables</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEQN, RIAGENDR, RIDAGEYR) <span class="sc">%&gt;%</span>    <span class="co"># keep columns</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gender =</span> RIAGENDR) <span class="sc">%&gt;%</span>           <span class="co"># rename columns</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(RIDAGEYR, <span class="at">.before =</span> gender) <span class="sc">%&gt;%</span>    <span class="co"># move columns</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEYR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31127</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: right;">31128</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31129</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31131</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="even">
<td style="text-align: right;">31132</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">Male</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Tidyselect patterns:</strong> select columns by name or type</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEQN, <span class="fu">starts_with</span>(<span class="st">"RID"</span>), <span class="fu">ends_with</span>(<span class="st">"YR"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDSTATR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDEXMON</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEYR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEMN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEEX</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDRETH1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIDEXPRG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SDDSRVYR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTINT2YR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTMEC2YR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31127</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: right;">6435</td>
<td style="text-align: right;">6571</td>
</tr>
<tr class="even">
<td style="text-align: right;">31128</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">November 1 through April 30</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">132</td>
<td style="text-align: left;">Non-Hispanic Black</td>
<td style="text-align: left;">SP not pregnant at exam</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: right;">9082</td>
<td style="text-align: right;">8987</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31129</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">190</td>
<td style="text-align: left;">Non-Hispanic Black</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: right;">5317</td>
<td style="text-align: right;">5587</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: right;">29961</td>
<td style="text-align: right;">34031</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31131</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">535</td>
<td style="text-align: right;">536</td>
<td style="text-align: left;">Non-Hispanic Black</td>
<td style="text-align: left;">SP not pregnant at exam</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: right;">26458</td>
<td style="text-align: right;">26771</td>
</tr>
<tr class="even">
<td style="text-align: right;">31132</td>
<td style="text-align: left;">Both Interviewed and MEC examined</td>
<td style="text-align: left;">May 1 through October 31</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">842</td>
<td style="text-align: right;">843</td>
<td style="text-align: left;">Non-Hispanic White</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: right;">32962</td>
<td style="text-align: right;">35316</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>bmx_q <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric), <span class="fu">matches</span>(<span class="st">"^BMX"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXRECUM</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMIHEAD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXHT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXBMI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXLEG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXCALF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARML</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXARMC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXWAIST</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTHICR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXTRI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BMXSUB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31127</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">10.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">31128</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31129</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">17.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31131</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">31132</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">22.2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You can also drop columns with a leading <code>-</code> inside <code>select()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"RID"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SDDSRVYR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RIAGENDR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMQMILIT</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDBORN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDCITZN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDYRSUS</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDEDUC3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDEDUC2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDSCHOL</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDMARTL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDHHSIZ</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDFMSIZ</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">INDHHINC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">INDFMINC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">INDFMPIR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRGND</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DMDHRAGE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRBRN</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHREDU</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHRMAR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DMDHSEDU</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIALANG</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIAPROXY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MIAINTRP</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AIALANG</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTINT2YR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">WTMEC2YR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDMVPSU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDMVSTRA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31127</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">High School Grad/GED or equivalent</td>
<td style="text-align: left;">Married</td>
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">6435</td>
<td style="text-align: right;">6571</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="even">
<td style="text-align: right;">31128</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">4th Grade</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">In school</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">$45,000 to $54,999</td>
<td style="text-align: left;">$20,000 to $24,999</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">9-11th Grade (Includes 12th grade with no diploma)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">9082</td>
<td style="text-align: right;">8987</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31129</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">10th Grade</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">In school</td>
<td style="text-align: left;">Never married</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">$65,000 to $74,999</td>
<td style="text-align: left;">$65,000 to $74,999</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">Married</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">5317</td>
<td style="text-align: right;">5587</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: left;">$15,000 to $19,999</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">Widowed</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">29961</td>
<td style="text-align: right;">34031</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31131</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Married</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">$75,000 and Over</td>
<td style="text-align: left;">$75,000 and Over</td>
<td style="text-align: right;">4.65</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: left;">Married</td>
<td style="text-align: left;">Some College or AA degree</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">26458</td>
<td style="text-align: right;">26771</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: right;">31132</td>
<td style="text-align: left;">NHANES 2005-2006 Public Release</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">Citizen by birth or naturalization</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Married</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">$75,000 and Over</td>
<td style="text-align: left;">$75,000 and Over</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">Born in 50 US States or Washington, DC</td>
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: left;">Married</td>
<td style="text-align: left;">College Graduate or above</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">English</td>
<td style="text-align: right;">32962</td>
<td style="text-align: right;">35316</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">52</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Conditional transforms:</strong> create variables with <code>if_else()</code> and <code>case_when()</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">adult =</span> <span class="fu">if_else</span>(RIDAGEYR <span class="sc">&gt;=</span> <span class="dv">18</span>, <span class="st">"adult"</span>, <span class="st">"minor"</span>),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      RIDAGEYR <span class="sc">&lt;</span> <span class="dv">18</span> <span class="sc">~</span> <span class="st">"child"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      RIDAGEYR <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">~</span> <span class="st">"adult"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"older adult"</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SEQN, RIDAGEYR, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RIDAGEYR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age_group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31127</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">child</td>
</tr>
<tr class="even">
<td style="text-align: right;">31128</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">child</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31129</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">child</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: right;">85</td>
<td style="text-align: left;">older adult</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31131</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">adult</td>
</tr>
<tr class="even">
<td style="text-align: right;">31132</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">older adult</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Mutate across:</strong> apply the same transformation to multiple columns</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>bmx_q <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(BMXWT, BMXARML, BMXTHICR),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> .x <span class="sc">-</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.names =</span> <span class="st">"centered_{.col}"</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, <span class="fu">starts_with</span>(<span class="st">"centered_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">SEQN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">centered_BMXWT</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">centered_BMXARML</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">centered_BMXTHICR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">31127</td>
<td style="text-align: right;">-49.8</td>
<td style="text-align: right;">-16.7</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">31128</td>
<td style="text-align: right;">-19.9</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">-11.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31129</td>
<td style="text-align: right;">14.6</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">4.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">31130</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31131</td>
<td style="text-align: right;">15.2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">31132</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">-3.3</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Groups:</strong> summarize or mutate within groups</p>
<p><code>group_by()</code> can use multiple keys (e.g., <code>group_by(BTN, COMPANY)</code>) and <code>ungroup()</code> drops grouping when you’re done.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RIAGENDR) <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_age =</span> <span class="fu">mean</span>(RIDAGEYR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">RIAGENDR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">avg_age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">5080</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">5268</td>
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Grouping persists across verbs until you <code>ungroup()</code> (or use <code>.groups</code> in <code>summarize()</code>):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RIAGENDR) <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_age =</span> <span class="fu">mean</span>(RIDAGEYR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">overall_mean =</span> <span class="fu">mean</span>(RIDAGEYR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_table</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-condensed caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">overall_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Quick counting helpers:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(RIAGENDR)                      <span class="co"># counts per gender</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">RIAGENDR</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">5080</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">5268</td>
</tr>
</tbody>
</table>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_edu =</span> <span class="fu">n_distinct</span>(DMDHREDU))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">n_edu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For single summaries, you can also use <code>.by</code> instead of <code>group_by()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>demo_q <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_age =</span> <span class="fu">mean</span>(RIDAGEYR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> RIAGENDR <span class="co"># compute summary within gender without keeping groups</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">RIAGENDR</th>
<th style="text-align: right;">avg_age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>